import 'package:flutter/foundation.dart';
import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:jais/utils.dart';
import 'package:jais/views/home_view.dart';
import 'package:jais/widgets/episodes/episode_list.dart';
import 'package:jais/widgets/episodes/episode_loader_widget.dart';
import 'package:jais/widgets/episodes/episode_widget.dart';
import 'package:jais/widgets/top_navigation_bar.dart';
import 'package:nock/nock.dart';

void nockUrl() {
  nock('https://${Const.serverUrl}')
      .get('/episodes/country/fr/page/1/limit/12')
      .reply(
        200,
        '[{"uuid":"81dbf2b6-aa46-4fc8-a536-ab2572041129","anime":{"uuid":"83db09c1-6e67-4fa0-bca7-e3888caaed59","country":{"uuid":"a6029576-0071-41b8-a2eb-01b007d1d96c","tag":"fr","name":"France"},"name":"The Ice Guy \u0026 The Cool Girl","releaseDate":"2023-01-04T16:00:00Z","image":"https://www.crunchyroll.com/imgsrv/display/thumbnail/480x720/catalog/crunchyroll/ba93ce07c6039e72a3ca7976e4b62e21.jpe","description":"Himuro est un descendant d’une yuki-onna ! Il vit de nos jours et travaille comme employé de bureau. Mais lorsqu\u0027il est dépassé par ses émotions, il finit par provoquer des blizzards ou se met à construire des bonhommes de neige et des igloos. Quand ses sentiments secrets pour son unique et gentille collègue Fuyutsuki s\u0027intensifient, cela provoque chez lui des réactions glaciales ! Leur relation évolue progressivement au fil des jours, au travers des événements de leur vie professionnelle. Ils finissent par passer du temps l\u0027un avec l\u0027autre en dehors du travail, mais demeurent tous deux un peu maladroits lorsqu\u0027il s\u0027agit d\u0027amour…","hashes":["the-ice-guy-the-cool-girl"],"genres":[],"simulcasts":[{"uuid":"4de5f48d-57e9-4a71-940c-f47ee73a9714","season":"WINTER","year":2023}]},"episodeType":{"uuid":"8e8a9047-0901-4e53-a81c-fb7a462ca202","name":"EPISODE"},"langType":{"uuid":"5164e91f-10a5-4f01-a984-05c3d4b95b70","name":"SUBTITLES"},"hash":"CRUN-886526-VOSTFR","releaseDate":"2023-02-21T15:30:00Z","season":1,"number":8,"title":"Petite sœur ! Et Noël au ski","url":"https://www.crunchyroll.com/fr/the-ice-guy-and-his-cool-female-colleague/episode-8-the-little-sister-appears-christmas-on-the-slopes-886526","image":"https://img1.ak.crunchyroll.com/i/spire2-tmb/d0c8a44c439887598f576de1016ce1ba1676957521_full.jpg","duration":1420,"platform":{"uuid":"eb438d41-2152-4b4d-851b-cbb2c50201f4","name":"Crunchyroll","url":"https://www.crunchyroll.com/","image":"https://jais.ziedelth.fr/attachments/platforms/crunchyroll.jpg"}},{"uuid":"9be2aa8b-6139-40cd-9394-c741e4d4af89","anime":{"uuid":"49dc56c6-06f6-4b55-8123-e3b7d3b93158","country":{"uuid":"a6029576-0071-41b8-a2eb-01b007d1d96c","tag":"fr","name":"France"},"name":"Vinland Saga","releaseDate":"2023-01-09T16:30:00Z","image":"https://www.crunchyroll.com/imgsrv/display/thumbnail/480x720/catalog/crunchyroll/9bb5b744630ae41fe9e5d9c9cc7f8e14.jpe","description":"À la fin du premier millénaire, les guerriers les plus forts et les plus cruels de leur temps se sont répandus à travers le monde entier : les Vikings. Thorfinn, le fils de l’homme réputé comme étant le plus fort des guerriers, décide de passer sa vie sur les champs de batailles malgré son jeune âge tout en rêvant d’atteindre le légendaire continent que l’on appelle « Vinland ». Dans le tourbillon d’une époque troublée, la saga d’un vrai guerrier commence.","hashes":["vinland-saga"],"genres":[],"simulcasts":[{"uuid":"4de5f48d-57e9-4a71-940c-f47ee73a9714","season":"WINTER","year":2023}]},"episodeType":{"uuid":"8e8a9047-0901-4e53-a81c-fb7a462ca202","name":"EPISODE"},"langType":{"uuid":"7c40ea6a-baac-4875-836e-066b0b8b5bf8","name":"VOICE"},"hash":"CRUN-891438-VF","releaseDate":"2023-02-20T21:00:00Z","season":2,"number":4,"title":"L\u0027éveil","url":"https://www.crunchyroll.com/fr/vinland-saga/episode-4-awakening-891438","image":"https://img1.ak.crunchyroll.com/i/spire3-tmb/7bdf5fc7a8294f1a220e4799575f348d1675100672_full.jpg","duration":1554,"platform":{"uuid":"eb438d41-2152-4b4d-851b-cbb2c50201f4","name":"Crunchyroll","url":"https://www.crunchyroll.com/","image":"https://jais.ziedelth.fr/attachments/platforms/crunchyroll.jpg"}},{"uuid":"b77ebbfc-a7a8-4be4-9680-216648552a10","anime":{"uuid":"2f6b4be0-5e05-4a03-ab1d-9390b0e51e11","country":{"uuid":"a6029576-0071-41b8-a2eb-01b007d1d96c","tag":"fr","name":"France"},"name":"Reborn to Master the Blade: From Hero-King to Extraordinary Squire","releaseDate":"2023-01-09T19:15:00Z","image":"https://www.crunchyroll.com/imgsrv/display/thumbnail/480x720/catalog/crunchyroll/2da763f6a9b0cf95bb9874d988185744.jpe","description":"Après avoir consacré sa vie aux affaires de l\u0027État et au bien-être de ses sujets, l’ultime souhait d’Inglis de se débarrasser de son fardeau de roi pour se consacrer à l’entraînement a été exaucé, mais il va devoir vivre dans la peau d’une jolie fille ! Réincarné dans un avenir lointain en tant que descendante de célèbres chevaliers, Inglis peut désormais se concentrer sur la maîtrise des arts martiaux. Maintenant que son vœu a été réalisé, Inglis va pouvoir accomplir son rêve de devenir le plus puissant des chevaliers au front.","hashes":["reborn-to-master-the-blade-from-hero-king-to-extraordinary-squire"],"genres":[],"simulcasts":[{"uuid":"4de5f48d-57e9-4a71-940c-f47ee73a9714","season":"WINTER","year":2023}]},"episodeType":{"uuid":"8e8a9047-0901-4e53-a81c-fb7a462ca202","name":"EPISODE"},"langType":{"uuid":"5164e91f-10a5-4f01-a984-05c3d4b95b70","name":"SUBTITLES"},"hash":"CRUN-887109-VOSTFR","releaseDate":"2023-02-20T19:15:00Z","season":1,"number":7,"title":"La maladie des Menaces hiérales","url":"https://www.crunchyroll.com/fr/reborn-to-master-the-blade-from-hero-king-to-extraordinary-squire/episode-7-the-hyral-menass-disease-887109","image":"https://img1.ak.crunchyroll.com/i/spire3-tmb/9289fb10a6551074aee053e02460977d1676908867_full.jpg","duration":1429,"platform":{"uuid":"eb438d41-2152-4b4d-851b-cbb2c50201f4","name":"Crunchyroll","url":"https://www.crunchyroll.com/","image":"https://jais.ziedelth.fr/attachments/platforms/crunchyroll.jpg"}},{"uuid":"7b4a9ccd-d5d1-452d-ae43-e610d9a4e7c6","anime":{"uuid":"39e6e076-ceed-4712-a8c2-6c617834ac18","country":{"uuid":"a6029576-0071-41b8-a2eb-01b007d1d96c","tag":"fr","name":"France"},"name":"Play It Cool, Guys","releaseDate":"2022-10-24T18:00:00Z","image":"https://www.crunchyroll.com/imgsrv/display/thumbnail/480x720/catalog/crunchyroll/9faef32c186fa903db78a1fe0ab342c9.jpeg","description":"À première vue, ces types ont l’air cool et beaux gosses. On a envie de faire leur connaissance, mais on se rend compte alors qu’ils sont vraiment étourdis ! L’un oublie son portefeuille, l’autre fait profiter de sa musique dans le train, un troisième porte des lunettes alors qu’il a des lentilles... Malgré leur maladresse, ces types ont toujours l’air décontractés. Suivez dans leur quotidien et vous tomberez probablement amoureux d’eux, vous aussi !","hashes":["play-it-cool-guys"],"genres":[],"simulcasts":[{"uuid":"4de5f48d-57e9-4a71-940c-f47ee73a9714","season":"WINTER","year":2023},{"uuid":"c0f034b3-8eaa-490b-8326-e7aec8f548d8","season":"AUTUMN","year":2022}]},"episodeType":{"uuid":"8e8a9047-0901-4e53-a81c-fb7a462ca202","name":"EPISODE"},"langType":{"uuid":"5164e91f-10a5-4f01-a984-05c3d4b95b70","name":"SUBTITLES"},"hash":"CRUN-887400-VOSTFR","releaseDate":"2023-02-20T19:00:00Z","season":1,"number":19,"title":"Un nouveau membre","url":"https://www.crunchyroll.com/fr/play-it-cool-guys/episode-19-new-member-887400","image":"https://img1.ak.crunchyroll.com/i/spire3-tmb/6105f0e539c6c546bce432b50f3cd8391676908985_full.jpg","duration":670,"platform":{"uuid":"eb438d41-2152-4b4d-851b-cbb2c50201f4","name":"Crunchyroll","url":"https://www.crunchyroll.com/","image":"https://jais.ziedelth.fr/attachments/platforms/crunchyroll.jpg"}},{"uuid":"68aa105b-e326-446c-a287-ad68f512b25e","anime":{"uuid":"86b274a7-852c-4c4c-9f6f-cb97eab6d27f","country":{"uuid":"a6029576-0071-41b8-a2eb-01b007d1d96c","tag":"fr","name":"France"},"name":"Eternal Boys","releaseDate":"2022-10-24T17:00:00Z","image":"https://image.animationdigitalnetwork.fr/license/eternalboys/tv/web/affiche_350x500.jpg","description":"Bien que rien ne semble les lier, six hommes ayant connu des échecs successifs dans leur vie personnelle et professionnelle décident de se lancer un nouveau défi : montrer qu’ils sont capables, en dépit de leur âge, d’atteindre les sommets de la gloire et de la célébrité. Ensemble, ils forment les « Eternal Boys », un groupe d’idols de quadragénaires.","hashes":["eternal-boys"],"genres":[],"simulcasts":[{"uuid":"4de5f48d-57e9-4a71-940c-f47ee73a9714","season":"WINTER","year":2023},{"uuid":"c0f034b3-8eaa-490b-8326-e7aec8f548d8","season":"AUTUMN","year":2022}]},"episodeType":{"uuid":"8e8a9047-0901-4e53-a81c-fb7a462ca202","name":"EPISODE"},"langType":{"uuid":"5164e91f-10a5-4f01-a984-05c3d4b95b70","name":"SUBTITLES"},"hash":"ANIM-20469-VOSTFR","releaseDate":"2023-02-20T18:00:00Z","season":1,"number":24,"title":"Eternal Boys","url":"https://animationdigitalnetwork.fr/video/eternal-boys/20469-episode-24-eternal-boys","image":"https://image.animationdigitalnetwork.fr/license/eternalboys/tv/web/eps24_640x360.jpg","duration":780,"platform":{"uuid":"aab7ec1a-f2f5-4edc-b9a5-5eb025e228c3","name":"Animation Digital Network","url":"https://animationdigitalnetwork.fr/","image":"https://jais.ziedelth.fr/attachments/platforms/animation_digital_network.jpg"}},{"uuid":"5795a3af-3bd0-4a6c-8c45-b42de7e772de","anime":{"uuid":"86b274a7-852c-4c4c-9f6f-cb97eab6d27f","country":{"uuid":"a6029576-0071-41b8-a2eb-01b007d1d96c","tag":"fr","name":"France"},"name":"Eternal Boys","releaseDate":"2022-10-24T17:00:00Z","image":"https://image.animationdigitalnetwork.fr/license/eternalboys/tv/web/affiche_350x500.jpg","description":"Bien que rien ne semble les lier, six hommes ayant connu des échecs successifs dans leur vie personnelle et professionnelle décident de se lancer un nouveau défi : montrer qu’ils sont capables, en dépit de leur âge, d’atteindre les sommets de la gloire et de la célébrité. Ensemble, ils forment les « Eternal Boys », un groupe d’idols de quadragénaires.","hashes":["eternal-boys"],"genres":[],"simulcasts":[{"uuid":"4de5f48d-57e9-4a71-940c-f47ee73a9714","season":"WINTER","year":2023},{"uuid":"c0f034b3-8eaa-490b-8326-e7aec8f548d8","season":"AUTUMN","year":2022}]},"episodeType":{"uuid":"8e8a9047-0901-4e53-a81c-fb7a462ca202","name":"EPISODE"},"langType":{"uuid":"5164e91f-10a5-4f01-a984-05c3d4b95b70","name":"SUBTITLES"},"hash":"ANIM-20468-VOSTFR","releaseDate":"2023-02-20T18:00:00Z","season":1,"number":23,"title":"Le Budokan","url":"https://animationdigitalnetwork.fr/video/eternal-boys/20468-episode-23-le-budokan","image":"https://image.animationdigitalnetwork.fr/license/eternalboys/tv/web/eps23_640x360.jpg","duration":780,"platform":{"uuid":"aab7ec1a-f2f5-4edc-b9a5-5eb025e228c3","name":"Animation Digital Network","url":"https://animationdigitalnetwork.fr/","image":"https://jais.ziedelth.fr/attachments/platforms/animation_digital_network.jpg"}},{"uuid":"2a50dbb8-6354-4ae9-b181-337149af881c","anime":{"uuid":"86b274a7-852c-4c4c-9f6f-cb97eab6d27f","country":{"uuid":"a6029576-0071-41b8-a2eb-01b007d1d96c","tag":"fr","name":"France"},"name":"Eternal Boys","releaseDate":"2022-10-24T17:00:00Z","image":"https://image.animationdigitalnetwork.fr/license/eternalboys/tv/web/affiche_350x500.jpg","description":"Bien que rien ne semble les lier, six hommes ayant connu des échecs successifs dans leur vie personnelle et professionnelle décident de se lancer un nouveau défi : montrer qu’ils sont capables, en dépit de leur âge, d’atteindre les sommets de la gloire et de la célébrité. Ensemble, ils forment les « Eternal Boys », un groupe d’idols de quadragénaires.","hashes":["eternal-boys"],"genres":[],"simulcasts":[{"uuid":"4de5f48d-57e9-4a71-940c-f47ee73a9714","season":"WINTER","year":2023},{"uuid":"c0f034b3-8eaa-490b-8326-e7aec8f548d8","season":"AUTUMN","year":2022}]},"episodeType":{"uuid":"8e8a9047-0901-4e53-a81c-fb7a462ca202","name":"EPISODE"},"langType":{"uuid":"5164e91f-10a5-4f01-a984-05c3d4b95b70","name":"SUBTITLES"},"hash":"ANIM-20467-VOSTFR","releaseDate":"2023-02-20T18:00:00Z","season":1,"number":22,"title":"L\u0027Album","url":"https://animationdigitalnetwork.fr/video/eternal-boys/20467-episode-22-l-album","image":"https://image.animationdigitalnetwork.fr/license/eternalboys/tv/web/eps22_640x360.jpg","duration":780,"platform":{"uuid":"aab7ec1a-f2f5-4edc-b9a5-5eb025e228c3","name":"Animation Digital Network","url":"https://animationdigitalnetwork.fr/","image":"https://jais.ziedelth.fr/attachments/platforms/animation_digital_network.jpg"}},{"uuid":"ce62ef7b-797e-4609-9dec-8a59fd2a15c2","anime":{"uuid":"86b274a7-852c-4c4c-9f6f-cb97eab6d27f","country":{"uuid":"a6029576-0071-41b8-a2eb-01b007d1d96c","tag":"fr","name":"France"},"name":"Eternal Boys","releaseDate":"2022-10-24T17:00:00Z","image":"https://image.animationdigitalnetwork.fr/license/eternalboys/tv/web/affiche_350x500.jpg","description":"Bien que rien ne semble les lier, six hommes ayant connu des échecs successifs dans leur vie personnelle et professionnelle décident de se lancer un nouveau défi : montrer qu’ils sont capables, en dépit de leur âge, d’atteindre les sommets de la gloire et de la célébrité. Ensemble, ils forment les « Eternal Boys », un groupe d’idols de quadragénaires.","hashes":["eternal-boys"],"genres":[],"simulcasts":[{"uuid":"4de5f48d-57e9-4a71-940c-f47ee73a9714","season":"WINTER","year":2023},{"uuid":"c0f034b3-8eaa-490b-8326-e7aec8f548d8","season":"AUTUMN","year":2022}]},"episodeType":{"uuid":"8e8a9047-0901-4e53-a81c-fb7a462ca202","name":"EPISODE"},"langType":{"uuid":"5164e91f-10a5-4f01-a984-05c3d4b95b70","name":"SUBTITLES"},"hash":"ANIM-20466-VOSTFR","releaseDate":"2023-02-20T18:00:00Z","season":1,"number":21,"title":"Les Vies de Nikolai Asakura","url":"https://animationdigitalnetwork.fr/video/eternal-boys/20466-episode-21-les-vies-de-nikolai-asakura","image":"https://image.animationdigitalnetwork.fr/license/eternalboys/tv/web/eps21_640x360.jpg","duration":780,"platform":{"uuid":"aab7ec1a-f2f5-4edc-b9a5-5eb025e228c3","name":"Animation Digital Network","url":"https://animationdigitalnetwork.fr/","image":"https://jais.ziedelth.fr/attachments/platforms/animation_digital_network.jpg"}},{"uuid":"4665f753-e4dc-425c-9dc2-f466238abe55","anime":{"uuid":"5e8f5436-7723-4501-a7d5-08be7ef4288d","country":{"uuid":"a6029576-0071-41b8-a2eb-01b007d1d96c","tag":"fr","name":"France"},"name":"Malevolent Spirits: Mononogatari","releaseDate":"2023-01-09T18:00:00Z","image":"https://www.crunchyroll.com/imgsrv/display/thumbnail/480x720/catalog/crunchyroll/2e90fd53ee309d204ac44ab72d35b2df.jpe","description":"Rempli de rage contre les esprits connus sous le nom de “tsukumogami”, Kunato Hyôma est envoyé chez Botan Nagatsuki pour l\u0027aider à les voir autrement. Bien que tous deux fassent partie d\u0027un clan renvoyant les esprits dans leur monde grâce à des pouvoirs surnaturels, leurs expériences respectives avec l\u0027autre monde sont très différentes. Tandis que Kunato a été privé d\u0027un être cher à cause d’eux, Botan a quant à elle été sauvée par ces derniers. Pourra-t-elle le faire changer d’avis ?","hashes":["malevolent-spirits-mononogatari"],"genres":[],"simulcasts":[{"uuid":"4de5f48d-57e9-4a71-940c-f47ee73a9714","season":"WINTER","year":2023}]},"episodeType":{"uuid":"8e8a9047-0901-4e53-a81c-fb7a462ca202","name":"EPISODE"},"langType":{"uuid":"5164e91f-10a5-4f01-a984-05c3d4b95b70","name":"SUBTITLES"},"hash":"CRUN-887096-VOSTFR","releaseDate":"2023-02-20T18:00:00Z","season":1,"number":7,"title":"Prémices","url":"https://www.crunchyroll.com/fr/malevolent-spirits-mononogatari/episode-7-quickening-887096","image":"https://img1.ak.crunchyroll.com/i/spire4-tmb/5f8059b5c5adafa7281684600e895b961676907606_full.jpg","duration":1419,"platform":{"uuid":"eb438d41-2152-4b4d-851b-cbb2c50201f4","name":"Crunchyroll","url":"https://www.crunchyroll.com/","image":"https://jais.ziedelth.fr/attachments/platforms/crunchyroll.jpg"}},{"uuid":"0c57c13c-45fa-4dc6-ae1a-1802a63ca84e","anime":{"uuid":"49dc56c6-06f6-4b55-8123-e3b7d3b93158","country":{"uuid":"a6029576-0071-41b8-a2eb-01b007d1d96c","tag":"fr","name":"France"},"name":"Vinland Saga","releaseDate":"2023-01-09T16:30:00Z","image":"https://www.crunchyroll.com/imgsrv/display/thumbnail/480x720/catalog/crunchyroll/9bb5b744630ae41fe9e5d9c9cc7f8e14.jpe","description":"À la fin du premier millénaire, les guerriers les plus forts et les plus cruels de leur temps se sont répandus à travers le monde entier : les Vikings. Thorfinn, le fils de l’homme réputé comme étant le plus fort des guerriers, décide de passer sa vie sur les champs de batailles malgré son jeune âge tout en rêvant d’atteindre le légendaire continent que l’on appelle « Vinland ». Dans le tourbillon d’une époque troublée, la saga d’un vrai guerrier commence.","hashes":["vinland-saga"],"genres":[],"simulcasts":[{"uuid":"4de5f48d-57e9-4a71-940c-f47ee73a9714","season":"WINTER","year":2023}]},"episodeType":{"uuid":"8e8a9047-0901-4e53-a81c-fb7a462ca202","name":"EPISODE"},"langType":{"uuid":"5164e91f-10a5-4f01-a984-05c3d4b95b70","name":"SUBTITLES"},"hash":"CRUN-887058-VOSTFR","releaseDate":"2023-02-20T16:30:00Z","season":2,"number":7,"title":"Ketil au poing de fer","url":"https://www.crunchyroll.com/fr/vinland-saga/episode-7-iron-fist-ketil-887058","image":"https://img1.ak.crunchyroll.com/i/spire3-tmb/3d990d7343977a8f2e9773c5f53fe7d91676907163_full.jpg","duration":1555,"platform":{"uuid":"eb438d41-2152-4b4d-851b-cbb2c50201f4","name":"Crunchyroll","url":"https://www.crunchyroll.com/","image":"https://jais.ziedelth.fr/attachments/platforms/crunchyroll.jpg"}},{"uuid":"3dd5ef39-2f3e-4613-a417-c003e1c8d4f1","anime":{"uuid":"820370d1-7e48-4581-ad9f-ffc9011c871f","country":{"uuid":"a6029576-0071-41b8-a2eb-01b007d1d96c","tag":"fr","name":"France"},"name":"The Vampire Dies in No Time","releaseDate":"2023-01-09T15:00:00Z","image":"https://www.crunchyroll.com/imgsrv/display/thumbnail/480x720/catalog/crunchyroll/b18b8f3b48f5892fb6e4486ff963637d.jpe","description":"Sus à l’ennemi ! Quand Ronald, chasseur de vampires, apprend qu’un enfant a été kidnappé, il se rend sur-le-champ au château de l’invincible Draluc. Loin du seigneur maléfique tel qu’il se l’était imaginé, le jeune homme découvre une mauviette qui tombe en poussière au moindre choc. Au grand dam de Ronald, il se retrouve à former une équipe malheureuse avec Draluc, la lie des vampires, et son fidèle John, tatou de compagnie. Entre personnages hauts en couleur et morts intempestives, l’aventure s’annonce rocambolesque !","hashes":["the-vampire-dies-in-no-time"],"genres":[],"simulcasts":[{"uuid":"4de5f48d-57e9-4a71-940c-f47ee73a9714","season":"WINTER","year":2023}]},"episodeType":{"uuid":"8e8a9047-0901-4e53-a81c-fb7a462ca202","name":"EPISODE"},"langType":{"uuid":"5164e91f-10a5-4f01-a984-05c3d4b95b70","name":"SUBTITLES"},"hash":"CRUN-887045-VOSTFR","releaseDate":"2023-02-20T15:00:00Z","season":2,"number":7,"title":"Hypnozizi","url":"https://www.crunchyroll.com/fr/the-vampire-dies-in-no-time/episode-7-put-a-sock-in-it-887045","image":"https://img1.ak.crunchyroll.com/i/spire3-tmb/60de3160ba2f38181fb538d50518decc1676898688_full.jpg","duration":1420,"platform":{"uuid":"eb438d41-2152-4b4d-851b-cbb2c50201f4","name":"Crunchyroll","url":"https://www.crunchyroll.com/","image":"https://jais.ziedelth.fr/attachments/platforms/crunchyroll.jpg"}},{"uuid":"654c757a-f98b-45fd-b846-9c7911b25738","anime":{"uuid":"ec71715e-083c-41fb-9845-5becd01d28ac","country":{"uuid":"a6029576-0071-41b8-a2eb-01b007d1d96c","tag":"fr","name":"France"},"name":"High Card","releaseDate":"2023-01-09T12:00:00Z","image":"https://image.animationdigitalnetwork.fr/license/highcard/tv/web/affiche_350x500.jpg","description":"Nation insulaire située dans l’Atlantique Nord, le royaume de Fourland a confié au gouvernement la mission d’assurer la protection d’un trésor national : cinquante-deux cartes qui octroient à chaque détenteur un pouvoir unique, l’élevant ainsi au rang de « joueur ». Mais l’ensemble de ce jeu se retrouve dispersé, ce qui trouble l’ordre établi, attisant la convoitise de bon nombre de personnes. Pinochle, l’une des plus grandes entreprises du pays, est mandatée afin de retrouver l’ensemble des cartes « X ». Justice, désir, vengeance : la bataille ne fait que commencer…","hashes":["high-card"],"genres":[],"simulcasts":[{"uuid":"4de5f48d-57e9-4a71-940c-f47ee73a9714","season":"WINTER","year":2023}]},"episodeType":{"uuid":"8e8a9047-0901-4e53-a81c-fb7a462ca202","name":"EPISODE"},"langType":{"uuid":"5164e91f-10a5-4f01-a984-05c3d4b95b70","name":"SUBTITLES"},"hash":"ANIM-22203-VOSTFR","releaseDate":"2023-02-20T12:00:00Z","season":1,"number":7,"title":"Love \u0026 Fake","url":"https://animationdigitalnetwork.fr/video/high-card/22203-episode-7-love-fake","image":"https://image.animationdigitalnetwork.fr/license/highcard/tv/web/eps7_640x360.jpg","duration":1420,"platform":{"uuid":"aab7ec1a-f2f5-4edc-b9a5-5eb025e228c3","name":"Animation Digital Network","url":"https://animationdigitalnetwork.fr/","image":"https://jais.ziedelth.fr/attachments/platforms/animation_digital_network.jpg"}}]',
      );
}

void main() {
  TestWidgetsFlutterBinding.ensureInitialized();

  setUpAll(nock.init);
  setUp(nock.cleanAll);

  group('HomeView Android', () {
    testWidgets('Launch on Mobile', (widgetTester) async {
      nockUrl();

      widgetTester.binding.window.physicalSizeTestValue = const Size(360, 640);
      widgetTester.binding.window.devicePixelRatioTestValue = 1.0;
      debugDefaultTargetPlatformOverride = TargetPlatform.android;

      await widgetTester.pumpWidget(const MaterialApp(home: HomeView()));
      debugDefaultTargetPlatformOverride = null;

      expect(find.byType(TopNavigationBar), findsOneWidget);
      expect(find.byType(VerticalDivider), findsNothing);
      expect(find.byType(EpisodeList), findsOneWidget);
      expect(find.byType(EpisodeLoaderWidget), findsAtLeastNWidgets(1));
      expect(find.byType(BottomNavigationBar), findsOneWidget);
      await widgetTester.pump();
      expect(find.byType(TopNavigationBar), findsOneWidget);
      expect(find.byType(VerticalDivider), findsNothing);
      expect(find.byType(EpisodeList), findsOneWidget);
      expect(find.byType(EpisodeWidget), findsAtLeastNWidgets(1));
      expect(find.byType(BottomNavigationBar), findsOneWidget);
    });

    testWidgets('Launch on Tablet', (WidgetTester widgetTester) async {
      nockUrl();

      widgetTester.binding.window.physicalSizeTestValue = const Size(900, 600);
      widgetTester.binding.window.devicePixelRatioTestValue = 1.0;
      debugDefaultTargetPlatformOverride = TargetPlatform.android;
      await widgetTester.pumpWidget(const MaterialApp(home: HomeView()));
      debugDefaultTargetPlatformOverride = null;

      expect(find.byType(TopNavigationBar), findsOneWidget);
      expect(find.byType(VerticalDivider), findsNothing);
      expect(find.byType(EpisodeList), findsOneWidget);
      expect(find.byType(EpisodeLoaderWidget), findsAtLeastNWidgets(3));
      expect(find.byType(BottomNavigationBar), findsOneWidget);
      await widgetTester.pump();
      expect(find.byType(TopNavigationBar), findsOneWidget);
      expect(find.byType(VerticalDivider), findsNothing);
      expect(find.byType(EpisodeList), findsOneWidget);
      expect(find.byType(EpisodeWidget), findsAtLeastNWidgets(3));
      expect(find.byType(BottomNavigationBar), findsOneWidget);
    });
  });
}
